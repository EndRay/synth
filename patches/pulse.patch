load init.patch

pulseCC = new CC("pulse width", 0.5)
cutoffCC = new CC("cutoff", 0.4)
envAmountCC = new CC("envelope amount", 0.7)

pulse = pulseCC
cutoff = cutoffCC
envAmount = envAmountCC.mapUni(-1, 1)

v: env = new AD(1ms, 0.4s)
v: env.gate <= gate

v: osc = new Pulse(pitch)
v: osc.pulse <= pulse

v: mix = new UMix()
v: mix <- osc

v: mix * env => output
v: filter = new Filter(cutoff)
v: filter.q := 0.2
v: env * velocity.mapUni(0.3, 1) * envAmount -> filter.f
v: filter ->- output

load init.patch

cutoffCC = new CC("cutoff", 0.4)
envAmountCC = new CC("envelope amount", 0.7)
keytrackCC = new CC("keytrack", 0.7)
resonanceCC = new CC("resonance", 0.2)

cutoff = cutoffCC.mapUni(-0.4, 1)
envAmount = envAmountCC.mapUni(-1, 1)
keytrack = keytrackCC
resonance = resonanceCC


v: env = new ADSR(1ms, 2s, 0.3, 0.6s)
v: env.att <= velocity.mapUni(3s + 2x, 1ms + 2x)
v: env.gate <= gate

v: osc = new Saw(pitch)
v: osc2 = new Saw(pitch + 1.01x)
v: mix = new UMix()
v: mix <- osc
v: mix <- osc2
v: mix * env => output

v: filter = new Filter(cutoff)
v: filter.f <- pitch * keytrack
v: filter.q <= resonance
v: env * velocity.mapUni(0.3, 1) * envAmount -> filter.f
v: filter ->- output
